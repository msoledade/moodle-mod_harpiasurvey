/**
 * Sortable table functionality for experiments table.
 *
 * @module     mod_harpiasurvey/sortable_table
 * @copyright  2025 Your Name
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_harpiasurvey/sortable_table",["jquery"],(function($){function sortTable(table,columnIndex,header){const tbody=table.find("tbody"),rows=tbody.find("tr").toArray(),headers=table.find("thead th");let sortDirection="asc";"asc"===header.data("sort-direction")&&(sortDirection="desc"),headers.each((function(){const h=$(this);h.removeClass("sort-asc sort-desc"),h.data("sort-direction",null);let text=h.html();text=text.replace(/ [↑↓↕]$/,""),h.html(text)})),header.addClass("sort-"+sortDirection),header.data("sort-direction",sortDirection);let headerText=header.html().replace(/ [↑↓↕]$/,"");const arrow="asc"===sortDirection?" ↑":" ↓";header.html(headerText+arrow),rows.sort((function(a,b){const aCell=$(a).find("td").eq(columnIndex),bCell=$(b).find("td").eq(columnIndex);let aText=aCell.text().trim(),bText=bCell.text().trim();if(1===columnIndex||2===columnIndex){const aNum=parseFloat(aText)||0,bNum=parseFloat(bText)||0;return aNum===bNum?0:"asc"===sortDirection?aNum-bNum:bNum-aNum}return aText=aText.toLowerCase(),bText=bText.toLowerCase(),aText===bText?0:"asc"===sortDirection?aText<bText?-1:1:aText>bText?-1:1})),tbody.empty(),rows.forEach((function(row){tbody.append(row)}))}return{init:function(tableSelector){const tables=$(tableSelector||'.harpiasurvey-sortable-table[data-sortable="true"], .harpiasurvey-sortable-table');tables.length&&tables.each((function(){!function(table){if(table.data("sortable-initialized"))return;table.data("sortable-initialized",!0);const headers=table.find("thead th");headers.each((function(index){const header=$(this);if(index===headers.length-1)return;header.css("cursor","pointer"),header.attr("role","button"),header.attr("tabindex","0");const headerText=header.text().trim().replace(/ [↑↓↕]$/,"");header.attr("aria-label",headerText+" - Click to sort"),header.on("click",(function(){sortTable(table,index,header)})),header.on("keypress",(function(e){13!==e.which&&32!==e.which||(e.preventDefault(),sortTable(table,index,header))}))}))}($(this))}))}}}));

//# sourceMappingURL=sortable_table.min.js.map