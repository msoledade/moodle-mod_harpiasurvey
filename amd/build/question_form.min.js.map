{"version":3,"file":"question_form.min.js","sources":["../src/question_form.js"],"sourcesContent":["// This file is part of Moodle - https://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <https://www.gnu.org/licenses/>.\n\n/**\n * Question form conditional fields module.\n *\n * @module     mod_harpiasurvey/question_form\n * @copyright  2025 Your Name\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\n\nlet initialized = false;\n\n/**\n * Initialize the question form conditional fields.\n */\nexport const init = () => {\n    if (initialized) {\n        return;\n    }\n\n    const updateFields = () => {\n        const typeSelect = document.getElementById('id_type');\n        if (!typeSelect) {\n            return;\n        }\n\n        const selectedType = typeSelect.value;\n\n        // Helper function to show/hide a section by header ID.\n        const toggleSection = (headerId, show) => {\n            const header = document.getElementById('id_' + headerId);\n            if (!header) {\n                return;\n            }\n\n            // Find the header's parent fitem and all following fitems until the next header.\n            const headerFitem = header.closest('.fitem');\n            if (!headerFitem) {\n                return;\n            }\n\n            // Get all following siblings until the next header.\n            let current = headerFitem.nextElementSibling;\n            const itemsToToggle = [headerFitem];\n\n            while (current) {\n                // Stop if we hit another header.\n                if (current.querySelector('h3, .fheader')) {\n                    break;\n                }\n                itemsToToggle.push(current);\n                current = current.nextElementSibling;\n            }\n\n            // Show or hide all items.\n            itemsToToggle.forEach((item) => {\n                item.style.display = show ? '' : 'none';\n            });\n\n            // Expand/collapse header if needed.\n            if (show) {\n                header.classList.add('expanded');\n                const collapsible = header.querySelector('.collapsible-actions');\n                if (collapsible) {\n                    collapsible.setAttribute('aria-expanded', 'true');\n                }\n            }\n        };\n\n        // Show/hide selection settings (for singlechoice, multiplechoice, select).\n        toggleSection('selection_settings', ['singlechoice', 'multiplechoice', 'select'].includes(selectedType));\n\n        // Show/hide number settings (for number type).\n        toggleSection('number_settings', selectedType === 'number');\n\n        // Show/hide AI settings (for aiconversation type).\n        toggleSection('ai_settings', selectedType === 'aiconversation');\n    };\n\n    // Listen for type changes.\n    $(document).on('change', '#id_type', updateFields);\n\n    // Initial update on page load.\n    updateFields();\n\n    initialized = true;\n};\n\n"],"names":["initialized","updateFields","typeSelect","document","getElementById","selectedType","value","toggleSection","headerId","show","header","headerFitem","closest","current","nextElementSibling","itemsToToggle","querySelector","push","forEach","item","style","display","classList","add","collapsible","setAttribute","includes","on"],"mappings":";;;;;;;8IAyBIA,aAAc,gBAKE,QACZA,yBAIEC,aAAe,WACXC,WAAaC,SAASC,eAAe,eACtCF,wBAICG,aAAeH,WAAWI,MAG1BC,cAAgB,CAACC,SAAUC,cACvBC,OAASP,SAASC,eAAe,MAAQI,cAC1CE,oBAKCC,YAAcD,OAAOE,QAAQ,cAC9BD,uBAKDE,QAAUF,YAAYG,yBACpBC,cAAgB,CAACJ,kBAEhBE,UAECA,QAAQG,cAAc,iBAG1BD,cAAcE,KAAKJ,SACnBA,QAAUA,QAAQC,sBAItBC,cAAcG,SAASC,OACnBA,KAAKC,MAAMC,QAAUZ,KAAO,GAAK,UAIjCA,KAAM,CACNC,OAAOY,UAAUC,IAAI,kBACfC,YAAcd,OAAOM,cAAc,wBACrCQ,aACAA,YAAYC,aAAa,gBAAiB,UAMtDlB,cAAc,qBAAsB,CAAC,eAAgB,iBAAkB,UAAUmB,SAASrB,eAG1FE,cAAc,kBAAoC,WAAjBF,cAGjCE,cAAc,cAAgC,mBAAjBF,mCAI/BF,UAAUwB,GAAG,SAAU,WAAY1B,cAGrCA,eAEAD,aAAc"}