{{!
    This file is part of Moodle - https://moodle.org/
    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.
    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.
    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <https://www.gnu.org/licenses/>.
}}
{{!
    @template mod_harpiasurvey/experiment_view

    Template for viewing an experiment with pages management.

    Context variables required for this template:
    * experimentname - The experiment name
    * pageslabel - Label for pages
    * questionsurl - URL to questions tab
    * pagesurl - URL to pages tab
    * questionslabel - Label for questions
    * pageslist - Array of pages
    * has_pages - Whether there are pages
    * nopages - No pages message
    * addpageurl - URL to add a page
    * addpagelabel - Label for add page button
    * selectpagetoadd - Message when no page selected
    * viewingpage - Whether viewing a page
    * editing - Whether editing
    * formhtml - Form HTML if editing
    * pageviewhtml - Page view HTML if viewing
    * backtocourseurl - URL to go back to course
    * backtocourselabel - Label for back button
}}
<div class="row">
    <!-- Left column: Page form/view (larger) -->
    <div class="col-md-9">
        <div class="card">
            <div class="card-body">
                {{#editing}}
                    <!-- Editing mode: show form -->
                    <h4>{{#str}}general, form{{/str}}</h4>
                    {{{formhtml}}}
                {{/editing}}
                {{^editing}}
                    {{#viewingpage}}
                        <!-- Viewing mode: show rendered page -->
                        {{{pageviewhtml}}}
                    {{/viewingpage}}
                    {{^viewingpage}}
                        <!-- No page selected -->
                        <p class="text-muted">{{selectpagetoadd}}</p>
                    {{/viewingpage}}
                {{/editing}}
            </div>
        </div>
    </div>

    <!-- Right column: Pages list (smaller, floated) -->
    <div class="col-md-3">
        <div class="card pages-menu-sticky" style="margin-left: -15px;">
            <div class="card-body">
                <h5>{{pageslabel}}</h5>

                {{#has_pages}}
                    <div class="list-group">
                        {{#pageslist}}
                            <div class="list-group-item list-group-item-action{{#is_active}} active{{/is_active}} d-flex justify-content-between align-items-center">
                                <a href="{{url}}" class="flex-grow-1 text-decoration-none{{#is_active}} text-primary{{/is_active}}">
                                    {{number}}. {{title}}
                                </a>
                                {{#canmanage}}
                                    <a href="{{deleteurl}}" class="ml-2 text-danger" title="{{#str}}delete, moodle{{/str}}">
                                        <i class="fa fa-trash"></i>
                                    </a>
                                {{/canmanage}}
                            </div>
                        {{/pageslist}}
                    </div>
                {{/has_pages}}
                {{^has_pages}}
                    <p class="text-muted small">{{nopages}}</p>
                {{/has_pages}}

                {{#canmanage}}
                    <!-- Add page button -->
                    <div class="mt-3">
                        <a href="{{addpageurl}}" class="btn btn-primary btn-sm btn-block">{{addpagelabel}}</a>
                    </div>
                {{/canmanage}}
            </div>
        </div>
    </div>
</div>

<!-- Back to course button -->
<div class="mt-3">
    <a href="{{backtocourseurl}}" class="btn btn-secondary">{{backtocourselabel}}</a>
</div>

